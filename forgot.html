<!DOCTYPE html>
<html lang="en">

<head>

  <!-- Required meta tags -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <!-- Twitter -->
  <meta name="twitter:site" content="@themepixels">
  <meta name="twitter:creator" content="@themepixels">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="DashForge">
  <meta name="twitter:description" content="Responsive Bootstrap 4 Dashboard Template">
  <meta name="twitter:image" content="http://themepixels.me/dashforge/img/dashforge-social.png">

  <!-- Facebook -->
  <meta property="og:url" content="http://themepixels.me/dashforge">
  <meta property="og:title" content="DashForge">
  <meta property="og:description" content="Responsive Bootstrap 4 Dashboard Template">

  <meta property="og:image" content="http://themepixels.me/dashforge/img/dashforge-social.png">
  <meta property="og:image:secure_url" content="http://themepixels.me/dashforge/img/dashforge-social.png">
  <meta property="og:image:type" content="image/png">
  <meta property="og:image:width" content="1200">
  <meta property="og:image:height" content="600">

  <!-- Meta -->
  <meta name="description" content="Responsive Bootstrap 4 Dashboard Template">
  <meta name="author" content="ThemePixels">

  <!-- Favicon -->
  <link rel="shortcut icon" type="image/x-icon" href="assets/img/favicon.png">

  <title>DashForge Responsive Bootstrap 4 Dashboard Template</title>

  <!-- vendor css -->
  <link href="lib/@fortawesome/fontawesome-free/css/all.min.css" rel="stylesheet">
  <link href="lib/ionicons/css/ionicons.min.css" rel="stylesheet">

  <!-- DashForge CSS -->
  <link rel="stylesheet" href="assets/css/dashforge.css">
  <link rel="stylesheet" href="assets/css/dashforge.auth.css">
</head>

<body>

  <header class="navbar navbar-header navbar-header-fixed">
    <a href="" id="mainMenuOpen" class="burger-menu"><i data-feather="menu"></i></a>
    <div class="navbar-brand">
      <a href="#" class="df-logo">dash<span>forge</span></a>
    </div><!-- navbar-brand -->
  </header><!-- navbar -->

  <div class="content content-fixed content-auth-alt">
    <div class="container d-flex justify-content-center ht-100p">
      <div class="mx-wd-300 wd-sm-450 ht-100p d-flex flex-column align-items-center justify-content-center">
        <div class="wd-80p wd-sm-300 mg-b-15"><img src="assets/img/undraw_personal_trainer_ote3.svg" class="img-fluid"
            alt=""></div>
        <h4 class="tx-20 tx-sm-24">Recuperar Contraseña</h4>
        <p class="tx-color-03 mg-b-30 tx-center">Ingrasar email y se te enviara un correo electrónico con un nueva
          contraseña.</p>
        <div class="wd-100p d-flex flex-column flex-sm-row mg-b-40">
          <input type="text" class="form-control wd-sm-250 flex-fill" placeholder="Ingresa correo" id="email">
          <button class="btn btn-brand-02 mg-sm-l-10 mg-t-10 mg-sm-t-0" onclick="Recovery();">Enviar</button>
        </div>
        <div class="form-group">
          <div role="alert" id="msg">
          </div>
        </div>
        <span class="tx-12 tx-color-03">Regresar al <a href="login.html">Login</a></span>

      </div>
    </div><!-- container -->
  </div><!-- content -->

  <footer class="footer">
    <div>
      <span>&copy; 2022 DashForge v1.0.0. </span>
    </div>
    <div>
      <nav class="nav">
        <span>Created by <a href="https://brandon-projects.cloud/" target="_blank">Brandon Rene</a></span>
      </nav>
    </div>
  </footer>

  <script src="lib/jquery/jquery.min.js"></script>
  <script src="lib/bootstrap/js/bootstrap.bundle.min.js"></script>
  <script src="lib/feather-icons/feather.min.js"></script>
  <script src="lib/perfect-scrollbar/perfect-scrollbar.min.js"></script>

  <script src="assets/js/dashforge.js"></script>

  <!-- append theme customizer -->
  <script src="lib/js-cookie/js.cookie.js"></script>
  <script>
    
    function makeid(length) {
      var result = '';
      var characters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';
      var charactersLength = characters.length;
      for (var i = 0; i < length; i++) {
        result += characters.charAt(Math.floor(Math.random() *
          charactersLength));
      }
      return result;
    }

    function Recovery() {
      let email = document.getElementById('email').value;
      let pass = makeid(8);
      let msg = document.getElementById("msg");
      let http = new XMLHttpRequest();
      let url = 'php/recovery_pass.php';
      let params = 'email=' + email + '&password=' + pass;

      if (email != '') {
        console.log(pass);
        msg.innerHTML = "";
        msg.className = "spinner-border text-success";

        http.open('POST', url, true);
        http.setRequestHeader('Content-type', 'application/x-www-form-urlencoded');
        http.onreadystatechange = function () {
          if (http.readyState == 4 && http.status == 200) {
            if (http.responseText == 1) {
              msg.className = "alert alert-success";
              msg.innerHTML = "Se ha enviado un correo con la nueva contraseña!.";
              console.log(JSON.parse(http.responseText));
            } else if (http.responseText == 2) {
              msg.className = "alert alert-danger";
              msg.innerHTML = "Ocurrio un error al actualizar la contraseña!.";
            } else if (http.responseText == 0) {
              msg.className = "alert alert-warning";
              msg.innerHTML = "El usuario no esta registrado!.";
            }
          }
        }
        http.send(params);
      } else {
        msg.className = "alert alert-danger";
        msg.innerHTML = "Debes ingresar tú correo!.";
      }
    }
  </script>
</body>

</html>